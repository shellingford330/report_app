<% provide(:title, "生徒一覧")%>
<section id="posts">
  <div class="container">
    <% if owner_logged_in? %>
    <div class="row">
      <div class="col-md-6 py-2">
        <%= link_to new_student_path, class: "btn btn-block" do %>
        <i class="fas fa-plus"></i> 生徒作成 <% end %>
      </div>
      <div class="col-md-6 py-2">
        <%= link_to students_upgrade_path , method: :post, data: { confirm:
        '本当によろしいですか？'} , class: "btn btn-block" do %>
        <i class="fas fa-check"></i> 学年を更新 <% end %>
      </div>
    </div>
    <% end %>
    <div id="accordion">
      <div class="row mt-2">
        <div class="col-md-9 mb-3">
          <div class="card">
            <div class="card-header" style="background-color: #e9d2b8; border-bottom: 2px solid #e9c7a1;">
              <h4>生徒一覧</h4>
            </div>
            <% @students.grades.each do |grade| %>
              <div style="background: #f0e7dd;" type="a" class="card-header" id="heading-<%= grade %>">
                <h5 class="mb-0">
                  <div
                    class="collapsed"
                    data-toggle="collapse"
                    data-target="#collapse-<%= grade %>"
                    aria-expanded="false"
                    aria-controls="collapse-<%= grade %>"
                  >
                    <i class="arrow fa fa-angle-right mr-2"></i><%= grade %>
                  </div>
                </h5>
              </div>
              <div
                id="collapse-<%= grade %>"
                class="collapse"
                aria-labelledby="heading-<%= grade %>"
                data-parent="#accordion"
              >
                <table class="table">
                    <tbody>
                      <% Student.where(grade: grade).each do |student| %>
                      <tr>
                        <td class="pl-4">
                          <%= link_to student do%>
                            <i class="fas fa-user-circle"></i>     <%= student.name %>
                          <% end %>
                        </td>
                        <td class="text-right">
                          <% if owner_logged_in? %>
                          <%= link_to student, method: :delete, data: { confirm:
                          '本当によろしいですか？'} , class: "btn btn-view bg-delete" do%>
                            <i class="fas fa-trash"></i> 削除 
                          <% end %> 
                          <% end %>
                          <%= link_to student, class: "btn btn-view" do %>
                            <i class="fas fa-angle-double-right"></i> 詳細 
                          <% end %>
                        </td>
                      </tr>
                      <% end %>
                    </tbody>
                </table>
              </div>
            <% end %>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-center card-bg-brown mb-3">
            <div class="card-body">
              <h3>講師一覧</h3>
              <h4 class="display-4">
                <i class="fas fa-users"></i> <%= Teacher.count %>
              </h4>
              <%= link_to '見る', teachers_path, class: "btn btn-view-brown" %>
            </div>
          </div>
          <div class="card text-center card-bg-blue mb-3">
            <div class="card-body">
              <h3>指導報告書</h3>
              <h4 class="display-4"><i class="fas fa-pencil-alt"></i> 6</h4>
              <%= link_to '見る', students_path, class: "btn btn-view-blue" %>
            </div>
          </div>
          <div class="card text-center card-bg-pink mb-3">
            <div class="card-body">
              <h3>お知らせ</h3>
              <h4 class="display-4"><i class="fas fa-clipboard"></i> 6</h4>
              <%= link_to '見る', students_path, class: "btn btn-view-pink" %>
            </div>
          </div>
          <div class="card text-center card-bg-green mb-3">
            <div class="card-body">
              <h3>お問い合わせ</h3>
              <h4 class="display-4"><i class="fas fa-envelope"></i> 6</h4>
              <%= link_to '見る', students_path, class: "btn btn-view-green" %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
