<% provide(:title, "詳細") %>
<div class="container my-4">
  <div class="row">
    <div class="col-md-9 mx-auto">

      <h3 class="mb-0 pl-3">
        <strong class="align-middle">お知らせ</strong>
      </h3>

      <hr>

      <div class="news-wrapper">

        <div class="news-title">
          「<%= @news.title %>」
        </div>

        <div class="news-info">
          書いた講師：<i class="fas fa-user-circle"></i>     <%= @news.teacher.name %>
        </div>
        <div class="news-info">
          日付：<%= @news.created_at.strftime('%Y年%m月%d日') %>
        </div>

        <div class="news-content">
          <%= safe_join(@news.content.split("\n"), tag(:br)) %><br/>
        </div>

        <%= link_to @news.upfile.original_filename, file_news_url(@news), method: :post, class: "link" if @news.upfile? %>

        <% if correct_teacher?(@news.teacher) || admin_logged_in? %>

          <hr>

          <div class="row">
            <div class="col-md-4 mt-2 mx-auto">
              <a href="#" class="btn btn-block" data-toggle="modal" data-target="#addNewsModal">
                <i class="fas fa-check"></i>  選択した生徒を確認
              </a>
            </div>

            <% if admin_logged_in? && draft?(@news) %>
              <div class="col-md-4 mt-2">
                <%= link_to release_news_url(@news), method: :post, class: "btn d-block" do %>
                  <i class="far fa-eye"></i> 公開する
                <% end %>
              </div>
            <% end %>

            <div class="col-md-4 mt-2 mx-auto">
              <%= link_to news_url(@news), data:{ confirm: "本当に削除してもよろしいですか" },
                method: :delete, class: "btn d-block bg-delete" do %>
                <i class="fas fa-trash"></i>  削除する
              <% end %>
            </div>
            
          </div>

          <!-- モーダル -->
          <div class="modal fade" id="addNewsModal">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header bg-news">
                  <h5 class="modal-title"><i class="far fa-check-circle"></i> 選択した生徒</h5>
                  <button class="close" data-dismiss="modal">
                    <span>&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <% @students.each do |student| %>
                    <p>
                      <%= student.grade %>
                                <i class="fas fa-user-circle"></i>
                      <%= student.name %>
                    </p>
                  <% end %>
                </div>
              </div>
            </div>
          </div>

        <% end %>
        
      </div>
      
    </div>
  </div>
</div>
